<form [formGroup]="form"
      *ngIf="form"
      class="page-form">

  <div class="form-group full-width">
    <mat-form-field>
      <mat-label>Titre de la facture</mat-label>
      <input matInput
             formControlName="title"
             required
             placeholder="Saisir un titre...">
      <mat-error *ngIf="title.invalid">Champs requis</mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-label>Numéro de facture</mat-label>
      <input matInput
             formControlName="code"
             required
             placeholder="Saisir un numéro...">
    </mat-form-field>

    <mat-form-field>
      <mat-label>Statut</mat-label>
      <mat-select placeholder="Sélectionner un status"
                  formControlName="state">
        <mat-option *ngFor="let state of InvoiceState | values"
                    [value]="state">
          {{state}}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <mat-slide-toggle formControlName="tvaActive">TVA</mat-slide-toggle>

  </div>

  <div class="form-group full-width">

    <mat-form-field>
      <mat-label>Date de validité</mat-label>
      <input matInput
             formControlName="validityDate"
             [matDatepicker]="picker"
             placeholder="Valide jusqu'au...">
      <mat-datepicker-toggle matSuffix
                             [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker></mat-datepicker>
    </mat-form-field>

  </div>

  <app-invoice-form-user-info [parentFormGroup]="form"></app-invoice-form-user-info>

  <app-invoice-form-customer-info [parentFormGroup]="form"></app-invoice-form-customer-info>

  <div class="actions">
    <button (click)="saveInvoice()"
            type="submit"
            mat-button>Valider</button>
  </div>

  <app-invoice-item-form #invoiceItemForm
                         [formArray]="invoiceItems"
                         (create)="createItem()"
                         (delete)="removeItem($event)">
  </app-invoice-item-form>

  <div>
    <mat-form-field *ngIf="tvaActive.value">
      <mat-label>Total HT</mat-label>
      <input matInput
             type="number"
             formControlName="amountDutyFree"
             required
             placeholder="Saisir un montant total HT...">
    </mat-form-field>
    <mat-form-field *ngIf="tvaActive.value">
      <mat-label>Total TVA</mat-label>
      <input matInput
             type="number"
             formControlName="tvaAmount"
             required
             placeholder="Saisir un total de TVA...">
    </mat-form-field>
    <mat-form-field>
      <mat-label>Montant total TTC</mat-label>
      <input matInput
             type="number"
             formControlName="amount"
             required
             placeholder="Saisir un montant total TTC...">
    </mat-form-field>
  </div>
</form>